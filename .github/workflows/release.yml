name: Release Application

on:
  push:
    paths:
      - 'VERSION'
    branches:
      - main
  workflow_dispatch:
    inputs:
      force_prerelease:
        description: 'Force pre-release (ignore VERSION format)'
        required: false
        type: boolean
        default: false

permissions:
  contents: write

jobs:
  prepare:
    name: Prepare Release
    runs-on: ubuntu-latest
    outputs:
      version: ${{ steps.read_version.outputs.version }}
      tag_name: ${{ steps.read_version.outputs.tag_name }}
      is_prerelease: ${{ steps.read_version.outputs.is_prerelease }}
      release_name: ${{ steps.read_version.outputs.release_name }}
      version_label: ${{ steps.read_version.outputs.version_label }}
    
    steps:
      - name: üì• Checkout repository
        uses: actions/checkout@v4

      - name: üìñ Read VERSION file and detect release type
        id: read_version
        run: |
          VERSION=$(cat VERSION | tr -d '[:space:]')
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "tag_name=v$VERSION" >> $GITHUB_OUTPUT
          
          # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø: –±–µ—Ç–∞ –µ—Å–ª–∏ –µ—Å—Ç—å -b –∏–ª–∏ -beta (—Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º)
          if [[ "$VERSION" =~ -(b|beta)[0-9]*$ ]]; then
            IS_PRERELEASE="true"
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä –±–µ—Ç—ã –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è
            if [[ "$VERSION" =~ -(b|beta)([0-9]+)$ ]]; then
              BETA_NUM="${BASH_REMATCH[2]}"
              LABEL="Beta $BETA_NUM"
            else
              LABEL="Beta"
            fi
            
            RELEASE_NAME="MuXolotl Converter v$VERSION ($LABEL)"
            echo "üß™ Detected BETA: $VERSION"
          else
            IS_PRERELEASE="false"
            LABEL="Stable"
            RELEASE_NAME="MuXolotl Converter v$VERSION"
            echo "üöÄ Detected STABLE: $VERSION"
          fi
          
          # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–µ-—Ä–µ–ª–∏–∑ —á–µ—Ä–µ–∑ workflow_dispatch
          if [ "${{ inputs.force_prerelease }}" == "true" ]; then
            IS_PRERELEASE="true"
            echo "‚ö†Ô∏è Forced pre-release via workflow input"
          fi
          
          echo "is_prerelease=$IS_PRERELEASE" >> $GITHUB_OUTPUT
          echo "release_name=$RELEASE_NAME" >> $GITHUB_OUTPUT
          echo "version_label=$LABEL" >> $GITHUB_OUTPUT
          
          echo "üì¶ Version: $VERSION"
          echo "üè∑Ô∏è Label: $LABEL"
          echo "üîñ Pre-release: $IS_PRERELEASE"

      - name: üì¶ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: üîÑ Sync version to all files
        run: node scripts/update-version.cjs

      - name: üíæ Commit synchronized files
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add package.json src-tauri/Cargo.toml src-tauri/tauri.conf.json README.md
          git diff --staged --quiet || git commit -m "chore: sync version ${{ steps.read_version.outputs.version }} to all files"
          git push

      - name: üè∑Ô∏è Create Git tag
        run: |
          git tag ${{ steps.read_version.outputs.tag_name }} || echo "Tag already exists"
          git push origin ${{ steps.read_version.outputs.tag_name }} || echo "Tag already pushed"

  build-and-release:
    name: Build ${{ matrix.name }}
    needs: prepare
    
    strategy:
      fail-fast: false
      matrix:
        include:
          - platform: windows-latest
            target: x86_64-pc-windows-msvc
            name: Windows x64
            bundles: "msi,nsis"

          - platform: ubuntu-22.04
            target: x86_64-unknown-linux-gnu
            name: Linux x64
            bundles: "deb"

          - platform: macos-latest
            target: x86_64-apple-darwin
            name: macOS Intel
            bundles: "dmg"

          - platform: macos-latest
            target: aarch64-apple-darwin
            name: macOS Apple Silicon
            bundles: "dmg"

    runs-on: ${{ matrix.platform }}

    steps:
      - name: üì• Checkout repository
        uses: actions/checkout@v4
        with:
          ref: main

      - name: ü¶Ä Setup Rust
        uses: dtolnay/rust-toolchain@stable
        with:
          targets: ${{ matrix.target }}

      - name: üì¶ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'npm'

      - name: üîß Install dependencies (Ubuntu)
        if: matrix.platform == 'ubuntu-22.04'
        run: |
          sudo apt-get update
          sudo apt-get install -y libgtk-3-dev libwebkit2gtk-4.0-dev libayatana-appindicator3-dev librsvg2-dev

      - name: üìÅ Create binaries directory
        run: mkdir -p src-tauri/binaries
        shell: bash

      - name: üì• Download and setup FFmpeg (Windows)
        if: matrix.platform == 'windows-latest'
        shell: bash
        run: |
          curl -L -o ffmpeg-temp.zip https://github.com/BtbN/FFmpeg-Builds/releases/download/latest/ffmpeg-master-latest-win64-gpl.zip
          unzip -q ffmpeg-temp.zip
          mv ffmpeg-master-latest-win64-gpl/bin/ffmpeg.exe src-tauri/binaries/ffmpeg-x86_64-pc-windows-msvc.exe
          mv ffmpeg-master-latest-win64-gpl/bin/ffprobe.exe src-tauri/binaries/ffprobe-x86_64-pc-windows-msvc.exe
          
          # Standalone package
          mkdir -p ffmpeg-standalone
          cp src-tauri/binaries/ffmpeg-x86_64-pc-windows-msvc.exe ffmpeg-standalone/ffmpeg.exe
          cp src-tauri/binaries/ffprobe-x86_64-pc-windows-msvc.exe ffmpeg-standalone/ffprobe.exe
          cp ffmpeg-master-latest-win64-gpl/LICENSE.txt ffmpeg-standalone/LICENSE-FFmpeg.txt
          cd ffmpeg-standalone && 7z a -tzip ../ffmpeg-windows-x64.zip * && cd ..
          
          # Cleanup
          rm -rf ffmpeg-master-latest-win64-gpl ffmpeg-temp.zip

      - name: üì• Download and setup FFmpeg (Linux)
        if: matrix.platform == 'ubuntu-22.04'
        run: |
          curl -L -o ffmpeg-temp.tar.xz https://johnvansickle.com/ffmpeg/releases/ffmpeg-release-amd64-static.tar.xz
          tar -xf ffmpeg-temp.tar.xz
          FFMPEG_DIR=$(find . -maxdepth 1 -type d -name "ffmpeg-*-amd64-static" | head -n 1)
          
          mv "$FFMPEG_DIR/ffmpeg" src-tauri/binaries/ffmpeg-x86_64-unknown-linux-gnu
          mv "$FFMPEG_DIR/ffprobe" src-tauri/binaries/ffprobe-x86_64-unknown-linux-gnu
          chmod +x src-tauri/binaries/ffmpeg-x86_64-unknown-linux-gnu
          chmod +x src-tauri/binaries/ffprobe-x86_64-unknown-linux-gnu
          
          # Standalone package
          mkdir -p ffmpeg-standalone
          cp src-tauri/binaries/ffmpeg-x86_64-unknown-linux-gnu ffmpeg-standalone/ffmpeg
          cp src-tauri/binaries/ffprobe-x86_64-unknown-linux-gnu ffmpeg-standalone/ffprobe
          cp "$FFMPEG_DIR/GPLv3.txt" ffmpeg-standalone/LICENSE-FFmpeg.txt
          tar -czf ffmpeg-linux-x64.tar.gz -C ffmpeg-standalone .
          
          # Cleanup
          rm -rf "$FFMPEG_DIR" ffmpeg-temp.tar.xz

      - name: üì• Download and setup FFmpeg (macOS Intel)
        if: matrix.platform == 'macos-latest' && matrix.target == 'x86_64-apple-darwin'
        run: |
          curl -L -o ffmpeg-temp.zip https://evermeet.cx/ffmpeg/getrelease/ffmpeg/zip
          curl -L -o ffprobe-temp.zip https://evermeet.cx/ffmpeg/getrelease/ffprobe/zip
          unzip -q ffmpeg-temp.zip
          unzip -q ffprobe-temp.zip
          
          mv ffmpeg src-tauri/binaries/ffmpeg-x86_64-apple-darwin
          mv ffprobe src-tauri/binaries/ffprobe-x86_64-apple-darwin
          chmod +x src-tauri/binaries/ffmpeg-x86_64-apple-darwin
          chmod +x src-tauri/binaries/ffprobe-x86_64-apple-darwin
          
          # Standalone package
          mkdir -p ffmpeg-standalone
          cp src-tauri/binaries/ffmpeg-x86_64-apple-darwin ffmpeg-standalone/ffmpeg
          cp src-tauri/binaries/ffprobe-x86_64-apple-darwin ffmpeg-standalone/ffprobe
          echo "FFmpeg GPL v2 / LGPL v2.1 - https://evermeet.cx/ffmpeg/" > ffmpeg-standalone/LICENSE-FFmpeg.txt
          cd ffmpeg-standalone && zip -r -q ../ffmpeg-macos-intel.zip . && cd ..
          
          # Cleanup
          rm -f ffmpeg-temp.zip ffprobe-temp.zip

      - name: üì• Download and setup FFmpeg (macOS ARM)
        if: matrix.platform == 'macos-latest' && matrix.target == 'aarch64-apple-darwin'
        run: |
          curl -L -o ffmpeg-temp.zip "https://evermeet.cx/ffmpeg/getrelease/ffmpeg/zip?arch=arm64"
          curl -L -o ffprobe-temp.zip "https://evermeet.cx/ffmpeg/getrelease/ffprobe/zip?arch=arm64"
          unzip -q ffmpeg-temp.zip
          unzip -q ffprobe-temp.zip
          
          mv ffmpeg src-tauri/binaries/ffmpeg-aarch64-apple-darwin
          mv ffprobe src-tauri/binaries/ffprobe-aarch64-apple-darwin
          chmod +x src-tauri/binaries/ffmpeg-aarch64-apple-darwin
          chmod +x src-tauri/binaries/ffprobe-aarch64-apple-darwin
          
          # Standalone package
          mkdir -p ffmpeg-standalone
          cp src-tauri/binaries/ffmpeg-aarch64-apple-darwin ffmpeg-standalone/ffmpeg
          cp src-tauri/binaries/ffprobe-aarch64-apple-darwin ffmpeg-standalone/ffprobe
          echo "FFmpeg GPL v2 / LGPL v2.1 - https://evermeet.cx/ffmpeg/" > ffmpeg-standalone/LICENSE-FFmpeg.txt
          cd ffmpeg-standalone && zip -r -q ../ffmpeg-macos-arm64.zip . && cd ..
          
          # Cleanup
          rm -f ffmpeg-temp.zip ffprobe-temp.zip

      - name: üì¶ Install npm dependencies
        run: npm ci

      - name: üèóÔ∏è Build Tauri app
        uses: tauri-apps/tauri-action@v0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          args: --target ${{ matrix.target }} --bundles ${{ matrix.bundles }}

      - name: üè∑Ô∏è Rename and cleanup artifacts
        shell: bash
        run: |
          VERSION="${{ needs.prepare.outputs.version }}"
          TARGET="${{ matrix.target }}"
          BUNDLE_DIR="src-tauri/target/$TARGET/release/bundle"
          
          echo "üìÅ Bundle directory: $BUNDLE_DIR"
          
          # Windows
          if [ "${{ matrix.platform }}" == "windows-latest" ]; then
            echo "ü™ü Processing Windows artifacts..."
            
            # MSI Installer
            if [ -d "$BUNDLE_DIR/msi" ]; then
              cd "$BUNDLE_DIR/msi"
              ORIGINAL_MSI=$(ls *.msi 2>/dev/null | head -n 1)
              if [ -n "$ORIGINAL_MSI" ]; then
                NEW_NAME="MuXolotl-Converter-${VERSION}-windows-x64-setup.msi"
                mv "$ORIGINAL_MSI" "$NEW_NAME"
                echo "‚úÖ Renamed: $ORIGINAL_MSI ‚Üí $NEW_NAME"
              fi
              cd -
            fi
            
            # NSIS Portable
            if [ -d "$BUNDLE_DIR/nsis" ]; then
              cd "$BUNDLE_DIR/nsis"
              ORIGINAL_EXE=$(ls *.exe 2>/dev/null | head -n 1)
              if [ -n "$ORIGINAL_EXE" ]; then
                NEW_NAME="MuXolotl-Converter-${VERSION}-windows-x64-portable.exe"
                mv "$ORIGINAL_EXE" "$NEW_NAME"
                echo "‚úÖ Renamed: $ORIGINAL_EXE ‚Üí $NEW_NAME"
              fi
              cd -
            fi
          fi
          
          # Linux
          if [ "${{ matrix.platform }}" == "ubuntu-22.04" ]; then
            echo "üêß Processing Linux artifacts..."
            
            if [ -d "$BUNDLE_DIR/deb" ]; then
              cd "$BUNDLE_DIR/deb"
              ORIGINAL_DEB=$(ls *.deb 2>/dev/null | head -n 1)
              if [ -n "$ORIGINAL_DEB" ]; then
                NEW_NAME="MuXolotl-Converter-${VERSION}-linux-x64.deb"
                mv "$ORIGINAL_DEB" "$NEW_NAME"
                echo "‚úÖ Renamed: $ORIGINAL_DEB ‚Üí $NEW_NAME"
              fi
              cd -
            fi
          fi
          
          # macOS Intel
          if [ "${{ matrix.platform }}" == "macos-latest" ] && [ "$TARGET" == "x86_64-apple-darwin" ]; then
            echo "üçé Processing macOS Intel artifacts..."
            
            if [ -d "$BUNDLE_DIR/dmg" ]; then
              cd "$BUNDLE_DIR/dmg"
              ORIGINAL_DMG=$(ls *.dmg 2>/dev/null | head -n 1)
              if [ -n "$ORIGINAL_DMG" ]; then
                NEW_NAME="MuXolotl-Converter-${VERSION}-macos-intel.dmg"
                mv "$ORIGINAL_DMG" "$NEW_NAME"
                echo "‚úÖ Renamed: $ORIGINAL_DMG ‚Üí $NEW_NAME"
              fi
              cd -
            fi
          fi
          
          # macOS ARM
          if [ "${{ matrix.platform }}" == "macos-latest" ] && [ "$TARGET" == "aarch64-apple-darwin" ]; then
            echo "üçé Processing macOS Apple Silicon artifacts..."
            
            if [ -d "$BUNDLE_DIR/dmg" ]; then
              cd "$BUNDLE_DIR/dmg"
              ORIGINAL_DMG=$(ls *.dmg 2>/dev/null | head -n 1)
              if [ -n "$ORIGINAL_DMG" ]; then
                NEW_NAME="MuXolotl-Converter-${VERSION}-macos-apple-silicon.dmg"
                mv "$ORIGINAL_DMG" "$NEW_NAME"
                echo "‚úÖ Renamed: $ORIGINAL_DMG ‚Üí $NEW_NAME"
              fi
              cd -
            fi
          fi
          
          echo "‚úÖ Artifact processing complete"

      # –†–µ–ª–∏–∑ –¥–ª—è –°–¢–ê–ë–ò–õ–¨–ù–û–ô –≤–µ—Ä—Å–∏–∏
      - name: üì§ Upload STABLE release
        if: needs.prepare.outputs.is_prerelease == 'false'
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ needs.prepare.outputs.tag_name }}
          name: ${{ needs.prepare.outputs.release_name }}
          body: |
            <div align="center">

            # ü¶é MuXolotl Converter v${{ needs.prepare.outputs.version }}

            **High-Performance Audio & Video Converter**

            ---

            ## üì¶ Download MuXolotl-Converter

            | OS | Link to installer file | FFmpeg Binaries |
            |-|-|-|
            | Windows Installer ***(Recommended)*** | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi) | [ffmpeg-windows-x64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-windows-x64.zip) |
            | Windows Portable | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe) | [ffmpeg-windows-x64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-windows-x64.zip) |
            | macOS Intel (x64) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg) | [ffmpeg-macos-intel.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-macos-intel.zip) |
            | macOS Apple Silicon (M1/M2/M3) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg) | [ffmpeg-macos-arm64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-macos-arm64.zip) |
            | Linux (Debian/Ubuntu) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb) | [ffmpeg-linux-x64.tar.gz](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-linux-x64.tar.gz) |

            ---

            **License**: GPL v2 / LGPL v2.1  
            **Built with**: Tauri ‚Ä¢ React ‚Ä¢ FFmpeg ‚Ä¢ Rust

            </div>
          draft: false
          prerelease: false
          files: |
            src-tauri/target/${{ matrix.target }}/release/bundle/msi/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi
            src-tauri/target/${{ matrix.target }}/release/bundle/nsis/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe
            src-tauri/target/${{ matrix.target }}/release/bundle/deb/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb
            src-tauri/target/${{ matrix.target }}/release/bundle/dmg/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg
            src-tauri/target/${{ matrix.target }}/release/bundle/dmg/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg
            ffmpeg-windows-x64.zip
            ffmpeg-linux-x64.tar.gz
            ffmpeg-macos-intel.zip
            ffmpeg-macos-arm64.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # –†–µ–ª–∏–∑ –¥–ª—è –ë–ï–¢–ê –≤–µ—Ä—Å–∏–∏
      - name: üì§ Upload BETA release
        if: needs.prepare.outputs.is_prerelease == 'true'
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ needs.prepare.outputs.tag_name }}
          name: ${{ needs.prepare.outputs.release_name }}
          body: |
            <div align="center">

            # üß™ MuXolotl Converter v${{ needs.prepare.outputs.version }}

            ### ‚ö†Ô∏è This is a ${{ needs.prepare.outputs.version_label }} release

            **For testing purposes only. May contain bugs.**

            ---

            ## üì¶ Download MuXolotl-Converter (${{ needs.prepare.outputs.version_label }})

            | OS | Link to installer file | FFmpeg Binaries |
            |-|-|-|
            | Windows Installer ***(Recommended)*** | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi) | [ffmpeg-windows-x64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-windows-x64.zip) |
            | Windows Portable | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe) | [ffmpeg-windows-x64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-windows-x64.zip) |
            | macOS Intel (x64) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg) | [ffmpeg-macos-intel.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-macos-intel.zip) |
            | macOS Apple Silicon (M1/M2/M3) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg) | [ffmpeg-macos-arm64.zip](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-macos-arm64.zip) |
            | Linux (Debian/Ubuntu) | [**MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb**](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb) | [ffmpeg-linux-x64.tar.gz](https://github.com/MuXolotl/MuXolotl-Converter/releases/download/${{ needs.prepare.outputs.tag_name }}/ffmpeg-linux-x64.tar.gz) |

            ---

            ## üêõ Found a bug?

            Please [open an issue](https://github.com/MuXolotl/MuXolotl-Converter/issues/new) with details.

            ---

            **License**: GPL v2 / LGPL v2.1  
            **Built with**: Tauri ‚Ä¢ React ‚Ä¢ FFmpeg ‚Ä¢ Rust

            </div>
          draft: false
          prerelease: true
          files: |
            src-tauri/target/${{ matrix.target }}/release/bundle/msi/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-setup.msi
            src-tauri/target/${{ matrix.target }}/release/bundle/nsis/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-windows-x64-portable.exe
            src-tauri/target/${{ matrix.target }}/release/bundle/deb/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-linux-x64.deb
            src-tauri/target/${{ matrix.target }}/release/bundle/dmg/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-intel.dmg
            src-tauri/target/${{ matrix.target }}/release/bundle/dmg/MuXolotl-Converter-${{ needs.prepare.outputs.version }}-macos-apple-silicon.dmg
            ffmpeg-windows-x64.zip
            ffmpeg-linux-x64.tar.gz
            ffmpeg-macos-intel.zip
            ffmpeg-macos-arm64.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
